# ============================================================================
# PLOS - Personal Life Operating System - Environment Template
# ============================================================================
# Updated: February 19, 2026
# Copy this file to .env and fill secrets for your environment
# ============================================================================

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================
APP_ENV=development
DEBUG=true
LOG_LEVEL=INFO
ENVIRONMENT=development
SERVICE_NAME=knowledge-base
PORT=8003
WORKERS=4

# ============================================================================
# GEMINI API (Google AI)
# ============================================================================
GEMINI_API_KEY_ROTATION_ENABLED=true
GEMINI_API_KEY_ROTATION_MAX_RETRIES=3
GEMINI_API_KEY_ROTATION_BACKOFF_SECONDS=60
GEMINI_API_KEYS=
# GEMINI_API_KEY=
GEMINI_DEFAULT_MODEL=gemini-2.5-flash
GEMINI_VISION_MODEL=gemini-2.5-flash
GEMINI_PRO_MODEL=gemini-2.5-pro
GEMINI_EMBEDDING_MODEL=text-embedding-004
USE_GEMINI_CACHING=true

# ============================================================================
# DATABASE (POSTGRES / SUPABASE)
# ============================================================================
POSTGRES_USER=postgres
POSTGRES_PASSWORD=plos_db_secure_2025
POSTGRES_DB=plos
POSTGRES_HOST=supabase-db
POSTGRES_PORT=5432
POSTGRES_URL=postgresql://postgres:plos_db_secure_2025@supabase-db:5432/plos
DATABASE_URL=postgresql+asyncpg://postgres:plos_db_secure_2025@supabase-db:5432/plos
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_KEY=your-supabase-service-key
SECRET_KEY_BASE=replace-with-random-secret

# ============================================================================
# SECURITY
# ============================================================================
JWT_SECRET=replace-with-strong-jwt-secret
JWT_ALGORITHM=HS256
JWT_EXP=3600
JWT_EXPIRATION=3600

# ============================================================================
# REDIS CACHE
# ============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=plos_redis_secure_2025
REDIS_URL=redis://:plos_redis_secure_2025@redis:6379/0
REDIS_TTL=3600
CACHE_L1_SIZE=1000
CACHE_L1_TTL=300
CACHE_L2_SIZE=100000
CACHE_L2_TTL=3600

# ============================================================================
# KAFKA MESSAGE BROKER
# ============================================================================
KAFKA_BROKERS=kafka:9092
KAFKA_BOOTSTRAP_SERVERS=kafka:9092
KAFKA_PARTITIONS=3
KAFKA_REPLICATION_FACTOR=1
KAFKA_DLQ_TOPIC=gemini-api-dlq
DLQ_RETENTION_DAYS=7
DLQ_AUTO_RETRY_ENABLED=true
DLQ_RETRY_DELAY_MS=5000

# ============================================================================
# API GATEWAY (KONG)
# ============================================================================
KONG_DATABASE=postgres
KONG_PG_HOST=supabase-db
KONG_PG_USER=postgres
KONG_PG_PASSWORD=plos_db_secure_2025
KONG_PG_DATABASE=kong

# ============================================================================
# KNOWLEDGE BASE / VECTOR / STORAGE
# ============================================================================
QDRANT_URL=http://qdrant:6333
QDRANT_HTTP_PORT=6333
QDRANT_GRPC_PORT=6334
QDRANT_API_KEY=
QDRANT_COLLECTION=documents
VECTOR_DIMENSION=768
HNSW_M=16
HNSW_EF_CONSTRUCT=128
HNSW_EF_SEARCH=64

MINIO_ENABLED=true
MINIO_ENDPOINT=minio:9000
MINIO_ROOT_USER=plos_minio_admin
MINIO_ROOT_PASSWORD=plos_minio_secure_2026
MINIO_ACCESS_KEY=plos_minio_admin
MINIO_SECRET_KEY=plos_minio_secure_2026
MINIO_BUCKET=knowledge-base-documents
MINIO_SECURE=false
MINIO_REGION=

MAX_FILE_SIZE=104857600
MAX_PAGES_PER_PDF=1000
CHUNK_SIZE=384
CHUNK_OVERLAP=76
MAX_CHUNK_SIZE=512
MIN_CHUNK_SIZE=100
OCR_PRIMARY=paddleocr
OCR_FALLBACK=tesseract
OCR_CONFIDENCE_THRESHOLD=0.85

EMBEDDING_PROVIDER=gemini
LOCAL_EMBEDDING_MODEL=all-MiniLM-L6-v2
SEARCH_TOP_K=10
SEARCH_RRF_K=60
SEMANTIC_WEIGHT=0.6
KEYWORD_WEIGHT=0.3
TYPO_WEIGHT=0.1
ENABLE_RERANKING=true
RERANKER_MODEL=cross-encoder/ms-marco-MiniLM-L-6-v2
RERANKER_BATCH_SIZE=32
ENTITY_CONFIDENCE_THRESHOLD=0.85

BATCH_SIZE=32
MAX_CONCURRENT_UPLOADS=10
WORKER_CONCURRENCY=4
LOG_FORMAT=json
STORAGE_PATH=./storage/documents
TEMP_PATH=./storage/temp
GRAPH_DB_PATH=./storage/knowledge_graph

KNOWLEDGE_BASE_WORKERS=4
KNOWLEDGE_BASE_EMBEDDING_PROVIDER=gemini
KNOWLEDGE_BASE_STORAGE_PATH=./storage/documents
KNOWLEDGE_BASE_TEMP_PATH=./storage/temp
KNOWLEDGE_BASE_GRAPH_DB_PATH=./storage/knowledge_graph

# ============================================================================
# SERVICE PORTS
# ============================================================================
API_GATEWAY_PORT=8000
CONTEXT_BROKER_PORT=8001
JOURNAL_PARSER_PORT=8002
KNOWLEDGE_BASE_PORT=8003
SUPABASE_STUDIO_PORT=3000
META_PORT=9085
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001

# ============================================================================
# MONITORING & TOOLS
# ============================================================================
PROMETHEUS_PORT=9090
GRAFANA_PORT=3333
METABASE_PORT=3001
KAFKA_UI_PORT=18080
REDIS_COMMANDER_PORT=8081

# ============================================================================
# CORS
# ============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
CORS_ALLOW_CREDENTIALS=true
